<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MTERMS 2026 – Committee Appointment Letter</title>
  <!-- Simple internal styling, only for this page -->
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f7fb;
    }

    .page {
      max-width: 900px;
      margin: 24px auto;
      padding: 24px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.06);
    }

    h1 {
      font-size: 20px;
      margin-bottom: 4px;
    }

    .subtitle {
      font-size: 14px;
      color: #666;
      margin-bottom: 24px;
    }

    .form-row {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 16px;
    }

    .field {
      flex: 1 1 260px;
      display: flex;
      flex-direction: column;
      font-size: 14px;
    }

    label {
      font-weight: 600;
      margin-bottom: 4px;
    }

    input, select {
      padding: 8px 10px;
      border-radius: 6px;
      border: 1px solid #ccd2e3;
      font-size: 14px;
      outline: none;
    }

    input:focus, select:focus {
      border-color: #3652d3;
      box-shadow: 0 0 0 2px rgba(54,82,211,0.15);
    }

    .actions {
      margin-top: 16px;
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .btn {
      border: none;
      border-radius: 999px;
      padding: 10px 20px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      text-decoration: none;
    }

    .btn-primary {
      background: #3652d3;
      color: #fff;
    }

    .btn-secondary {
      background: #e3e7f5;
      color: #333;
    }

    .note {
      font-size: 12px;
      color: #777;
      margin-top: 12px;
    }

    /* Printable letter style (hidden in normal view) */
    .letter-wrapper {
      width: 210mm;         /* A4 width */
      min-height: 297mm;    /* A4 height */
      padding: 20mm 20mm 25mm 20mm;
      box-sizing: border-box;
      background: #ffffff;
      color: #000000;
      font-family: "Times New Roman", serif;
      font-size: 12pt;
    }

    .letter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .letter-header img {
      max-height: 40px;
      object-fit: contain;
    }

    .letter-title {
      text-align: center;
      font-weight: bold;
      text-decoration: underline;
      margin-bottom: 20px;
      font-size: 14pt;
    }

    .letter-body p {
      margin: 0 0 10px 0;
      line-height: 1.5;
    }

    .signature-block {
      margin-top: 40px;
    }

    .signature-image {
      max-height: 50px;
      display: block;
      margin-bottom: 4px;
    }

    .letter-meta {
      font-size: 11pt;
      margin-bottom: 16px;
    }

  <!-- Hidden letter template for PDF generation -->
<div id="letterPreview" style="display:none;">
  <div class="letter-wrapper" style="
      width:210mm;
      min-height:297mm;
      padding:25mm;
      box-sizing:border-box;
      font-family:'Times New Roman', serif;
      font-size:11.5pt;
      color:#000;
    ">

    <!-- Logos Header -->
    <div style="
        display:flex;
        justify-content:space-between;
        align-items:center;
        margin-bottom:20px;
      ">
      
      <!-- MTERMS main logo -->
      <img src="public/mterm.jpg" alt="MTERMS Logo"
           style="height:55px;object-fit:contain;">

      <!-- Organiser Logos -->
      <div style="display:flex;gap:18px;align-items:center;">
        <img src="public/uitm.png" alt="UITM Logo" style="height:55px;object-fit:contain;">
        <img src="public/tesma.png" alt="TESMA Logo" style="height:55px;object-fit:contain;">
        <img src="public/mohe.png" alt="MOHE Logo" style="height:55px;object-fit:contain;">
      </div>
    </div>

    <!-- Title -->
    <div style="
        text-align:center;
        font-weight:bold;
        font-size:14pt;
        margin-bottom:16px;
        text-decoration:underline;
      ">
      APPOINTMENT LETTER – MTERMS 2026 ORGANIZING COMMITTEE
    </div>

    <!-- Ref & Date -->
    <div style="margin-bottom:14px;line-height:1.4;">
      Ref: MTERMS2026/COMMITTEE/<span id="metaRefCode"></span><br>
      Date: <span id="metaDate"></span>
    </div>

    <!-- Body -->
    <div style="text-align:justify;line-height:1.38;">

      <p style="margin:0 0 10px 0;">
        <strong>To:</strong><br>
        <span id="previewName"></span><br>
        Email: <span id="previewEmail"></span>
      </p>

      <p style="margin:0 0 10px 0;">
        Dear <span id="previewName2"></span>,
      </p>

      <p style="margin:0 0 10px 0;">
        We are pleased to formally appoint you as <strong><span id="previewRole"></span></strong> 
        for the <strong>Malaysian Tissue Engineering & Regenerative Medicine Scientific Meeting 2026 (MTERMS 2026)</strong>. 
        This appointment is in recognition of your expertise, experience, and commitment to advancing tissue engineering 
        and regenerative medicine in Malaysia.
      </p>

      <p style="margin:0 0 10px 0;">
        In this role, you will be part of the Organizing Committee responsible for supporting the planning, coordination 
        and successful delivery of MTERMS 2026. Your key responsibilities will include, but are not limited to:
      </p>

      <ul style="margin:0 0 10px 20px; padding:0; line-height:1.35;">
        <li>Providing input and advice within your area of responsibility;</li>
        <li>Attending and contributing to relevant committee meetings and discussions;</li>
        <li>Supporting the execution of activities leading up to and during the event; and</li>
        <li>Upholding the professional image and objectives of MTERMS 2026.</li>
      </ul>

      <p style="margin:0 0 10px 0;">
        This appointment is effective from <strong><span id="previewStartDate"></span></strong> and shall remain valid until 
        the completion of MTERMS 2026 and all related post-event activities, unless otherwise notified in writing by the 
        Organizing Committee.
      </p>

      <p style="margin:0 0 10px 0;">
        We would like to record our sincere appreciation for your willingness to serve and contribute your time and expertise. 
        We look forward to working closely with you towards a successful and impactful scientific meeting.
      </p>

      <p style="margin:0 0 10px 0;">
        Should you have any questions or require further clarification regarding this appointment, please do not hesitate to 
        contact the Organizing Committee Secretariat.
      </p>

      <p style="margin:0 0 16px 0;">
        Thank you, and congratulations on your appointment.
      </p>

      <!-- Signature -->
      <div style="margin-top:28px;">
        <p style="margin:0 0 6px 0;">Yours sincerely,</p>

        <img src="public/signaturesample.png" alt="Signature"
             style="height:55px;margin-bottom:4px;">

        <p style="margin:0;">
          <strong>Assoc. Prof. Ts. Dr. Nur Aliana Hidayah Bt Mohamed</strong><br>
          Vice President<br>
          MTERMS 2026 Organizing Committee
        </p>
      </div>
    </div>

    <!-- Footer -->
    <div style="
        text-align:center;
        margin-top:35px;
        font-size:11pt;
        opacity:0.8;
      ">
      MTERMS 2026 Organizing Committee
    </div>
  </div>
</div>


  <!-- html2pdf.js CDN (bundled with html2canvas + jsPDF) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <script>
    // Helper to format date as e.g. "23 November 2025"
    function formatDateLong(dateStr) {
      if (!dateStr) return "";
      const d = new Date(dateStr);
      const options = { day: "numeric", month: "long", year: "numeric" };
      return d.toLocaleDateString("en-MY", options);
    }

    function formatTodayLong() {
      const d = new Date();
      const options = { day: "numeric", month: "long", year: "numeric" };
      return d.toLocaleDateString("en-MY", options);
    }

    document.getElementById("generateBtn").addEventListener("click", function () {
      const name = document.getElementById("committeeName").value.trim();
      const email = document.getElementById("committeeEmail").value.trim();
      const role = document.getElementById("committeeRole").value;
      const startDate = document.getElementById("appointmentDate").value;

      if (!name) {
        alert("Please enter the committee member's name.");
        return;
      }
      if (!role) {
        alert("Please select a role.");
        return;
      }
      if (!startDate) {
        alert("Please select an appointment date.");
        return;
      }

      // Populate preview fields
      document.getElementById("previewName").textContent = name;
      document.getElementById("previewName2").textContent = name;
      document.getElementById("previewEmail").textContent = email || "-";
      document.getElementById("previewRole").textContent = role;
      document.getElementById("previewStartDate").textContent = formatDateLong(startDate);

      // Meta info: date on letter and a simple ref code (you can adjust pattern later)
      document.getElementById("metaDate").textContent = formatTodayLong();
      const simpleRef = new Date().getFullYear().toString().slice(-2) + "-" + Date.now().toString().slice(-4);
      document.getElementById("metaRefCode").textContent = simpleRef;

      const element = document.getElementById("letterPreview");
      element.style.display = "block"; // show for rendering

      const fileNameSafeName = name.replace(/[^a-z0-9]/gi, "_");
      const opt = {
        margin: 10,
        filename: "MTERMS2026_Appointment_" + fileNameSafeName + ".pdf",
        image: { type: "jpeg", quality: 0.98 },
        html2canvas: { scale: 2 },
        jsPDF: { unit: "mm", format: "a4", orientation: "portrait" }
      };

      html2pdf().from(element).set(opt).save().then(function () {
        element.style.display = "none"; // hide again after export
      });
    });
  </script>
</body>
</html>
